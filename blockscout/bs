#!/bin/bash
SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
cd "$SCRIPT_DIR"

source ./scripts/utils/utils.sh

blockscout-help() {
  echo -e "Usage:"
  echo -e "${B}$0 pulls|start|stop|remove|add-domains|static-envs <chain_id_offset?> <chainweb_chain_id_offset?> <number_of_chains?>${R}"
  echo -e ""
  echo -e "Examples:"
  echo -e "${B}$0 start${R}             Start with default values"
  echo -e "${B}$0 start 1789 20 2${R}   Start with 2 chains"
  echo -e "${B}$0 start 1234 20 2 ${R}  Start with chain ID offset 1234 and 2 chains"
  echo -e ""
  echo -e "Commands:"
  echo -e "  ${B}pull${R}          pull container images for all blockscout services."
  echo -e "  ${B}start|up${R}      Start the blockscout with specified parameters. used pull images or pull if not available."
  echo -e "  ${B}stop|down${R}     Stop the blockscout."
  echo -e "  ${B}remove|delete${R} Remove the blockscout data."
  echo -e "  ${B}add-domains${R}   Add domains to the host."
  echo -e "  ${B}static-envs${R}   create static environment variables files"
  echo -e ""
  echo -e "Arguments:"
  echo -e "  ${B}chain_id_offset${R}  The chain ID offset (default: 1789)."
  echo -e "  ${B}chainweb_chain_id_offset${R}  The chainweb chain ID offset (default: 20)."
  echo -e "  ${B}number_of_chains The number${R} of chains (default: 5)."
  echo -e ""
}

# Check if at least one argument is passed
if [ $# -lt 1 ]; then
  blockscout-help
  exit 1
fi

# Get the first argument as command
cmd="$1"
shift  # Remove the first argument so $@ is the rest

command_dir="./scripts/commands"

case "$cmd" in
  start|up)
    $command_dir/start "$@"
    ;;
  stop|down)
    $command_dir/stop "$@"
    ;;
  pull)
    $command_dir/pull "$@"
    ;;  
  remove|delete)
    $command_dir/remove "$@"
    ;;
  add-domains)
    $command_dir/add-domains "$@"
    ;;
  static-envs)
    $command_dir/static-envs "$@"
    ;;
  help|usage|h)
    blockscout-help
    ;;  
  *)
    blockscout-help
    exit 1
    ;;
esac
