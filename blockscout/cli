#!/bin/bash

KD_COMMANDS_DIR="$HOME/kd-commands"

# Show usage if no argument is provided
if [ -z "$1" ]; then
  echo "Usage:"
  echo "  KD <command> [args...]"
  echo "  KD help <command>"
  exit 1
fi

# Handle help
if [[ "$1" == "help" || "$2" == "--help" ]]; then
  CMD="${2:-$1}"
  DOC_FILE="$KD_COMMANDS_DIR/$CMD.txt"
  if [ -f "$DOC_FILE" ]; then
    cat "$DOC_FILE"
  else
    echo "No documentation found for '$CMD'"
  fi
  exit 0
fi

CMD="$1"
SCRIPT="$KD_COMMANDS_DIR/$CMD"

if [ -x "$SCRIPT" ]; then
  shift
  "$SCRIPT" "$@"
else
  echo "KD: '$CMD' not found or not executable in $KD_COMMANDS_DIR"
  exit 2
fi